<%- layout('layouts/main') %>

<section class="section">
    <div class="container">
        <div class="row">
            <!-- Sidebar -->
            <%- include('../../partials/profile-sidebar', { active: 'cursos' }) %>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <div class="profile-header mb-4">
                    <h1 class="page-title">
                        <i class="bi bi-mortarboard text-accent"></i> Mis Cursos
                    </h1>
                </div>
                
                <% if (typeof error !== 'undefined' && error) { %>
                    <div class="alert alert-danger">
                        <i class="bi bi-exclamation-circle"></i> <%= error %>
                    </div>
                <% } %>
                
                <% if (typeof courses === 'undefined' || courses.length === 0) { %>
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <i class="bi bi-mortarboard"></i>
                        </div>
                        <h3 class="empty-state-title">No tienes cursos</h3>
                        <p class="empty-state-text">Explora nuestro catálogo de cursos de reparación</p>
                        <a href="/cursos" class="btn btn-primary">Ver cursos</a>
                    </div>
                <% } else { %>
                    <div class="row g-4">
                        <% courses.forEach(course => { %>
                            <div class="col-md-6">
                                <div class="card enrolled-course-card h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start mb-3">
                                            <span class="level-badge <%= course.nivel %>"><%= course.nivel %></span>
                                            <span class="progress-badge">
                                                <%= course.progreso || 0 %>% completado
                                            </span>
                                        </div>
                                        
                                        <h5 class="card-title"><%= course.titulo %></h5>
                                        <p class="text-muted small mb-3">
                                            <i class="bi bi-person"></i> <%= course.instructor %>
                                        </p>
                                        
                                        <!-- Progress Bar -->
                                        <div class="course-progress mb-3">
                                            <div class="progress-bar-container">
                                                <div class="progress-bar-fill" style="width: <%= course.progreso || 0 %>%"></div>
                                            </div>
                                            <div class="progress-stats">
                                                <span><%= course.lecciones_completadas || 0 %>/<%= course.total_lecciones || 0 %> lecciones</span>
                                            </div>
                                        </div>
                                        
                                        <div class="d-flex justify-content-between align-items-center text-muted small mb-3">
                                            <span>
                                                <i class="bi bi-clock"></i> <%= course.duracion_horas %>h
                                            </span>
                                            <% if (course.fecha_ultimo_acceso) { %>
                                                <span>
                                                    Último acceso: <%= new Date(course.fecha_ultimo_acceso).toLocaleDateString() %>
                                                </span>
                                            <% } %>
                                        </div>
                                    </div>
                                    <div class="card-footer">
                                        <a href="/cursos/<%= course.slug %>/aprender" class="btn btn-primary w-100">
                                            <i class="bi bi-play-circle"></i> Continuar aprendiendo
                                        </a>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } %>
            </div>
        </div>
    </div>
</section>

<style>
.enrolled-course-card {
    transition: all var(--transition-fast);
}

.enrolled-course-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.progress-badge {
    padding: var(--space-1) var(--space-2);
    background: var(--accent);
    color: var(--bg-primary);
    border-radius: var(--radius-sm);
    font-size: 0.75rem;
    font-weight: 600;
}

.course-progress {
    padding: var(--space-3);
    background: var(--bg-secondary);
    border-radius: var(--radius-md);
}

.progress-bar-container {
    height: 8px;
    background: var(--bg-tertiary);
    border-radius: 4px;
    overflow: hidden;
}

.progress-bar-fill {
    height: 100%;
    background: var(--accent);
    border-radius: 4px;
    transition: width 0.5s ease;
}

.progress-stats {
    text-align: right;
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-top: var(--space-2);
}
</style>